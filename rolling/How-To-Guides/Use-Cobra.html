<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Using the Cobra Static Analyzer &mdash; Space ROS Documentation: Rolling  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="canonical" href="https://space-ros.github.io/docs/rolling/How-To-Guides/Use-Cobra.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using the MC/DC Testing Tool" href="MC-DC-Testing-Tool.html" />
    <link rel="prev" title="Reproducing CI Results Locally" href="Reproducing-CI-Results.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Space ROS Documentation: Rolling
            <img src="../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Introduction.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Introduction/About-Space-ROS.html">About Space ROS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Introduction/How-Space-ROS-Differs.html">How Space ROS Differs from ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Introduction/Dev-And-Release-Model.html">The Space ROS Development and Release Model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Getting-Started.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Getting-Started/Docker-Images.html">The Space ROS Docker Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Getting-Started/Building-From-Source.html">Building Space ROS from Source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Demos.html">Demos</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Demos/Canadarm.html">Canadarm Demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Demos/Mars-Rover.html">Mars Rover Demo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/First-Time-Building.html">First Time Building Space ROS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Eventing-And-Telemetry.html">The Eventing and Telemetry Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Requirements-Tools-And-Processes.html">Requirements Tools and Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Back-Porting-Requirements.html">Back-Porting Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Run-On-RTEMS.html">Running Space ROS on RTEMS</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../How-To-Guides.html">How-to Guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Use-Custom-Allocator.html">Using a Custom Memory Allocator with Space ROS</a></li>
<li class="toctree-l2"><a class="reference internal" href="Reproducing-CI-Results.html">Reproducing CI Results Locally</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Using the Cobra Static Analyzer</a></li>
<li class="toctree-l2"><a class="reference internal" href="MC-DC-Testing-Tool.html">Using the MC/DC Testing Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="Use-VSCode-With-Docker.html">Using VSCode with the Space ROS Docker Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="Use-The-Dashboard.html">Using the Space ROS Dashboard</a></li>
<li class="toctree-l2"><a class="reference internal" href="Use-Simulation-Assets.html">Using Space-Related Simulation Assets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Related-Projects.html">Related Projects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Related-Projects/IKOS.html">IKOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Related-Projects/Cobra.html">Cobra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Related-Projects/Doorstop.html">Doorstop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Related-Projects/FRET.html">FRET</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Related-Projects/Ogma.html">Ogma</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../The-Space-ROS-Project/Contributing.html">Contributing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Space ROS Documentation: Rolling</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../How-To-Guides.html">How-to Guides</a> &raquo;</li>
      <li>Using the Cobra Static Analyzer</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/space-ros/docs/blob/rolling/source/How-To-Guides/Use-Cobra.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="using-the-cobra-static-analyzer">
<h1>Using the Cobra Static Analyzer<a class="headerlink" href="#using-the-cobra-static-analyzer" title="Permalink to this headline"></a></h1>
<p>This guide explains how to use the Cobra static analyzer to check C and C++ source code for potential issues.</p>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#using-cobra-directly" id="id1">Using Cobra directly</a></p></li>
<li><p><a class="reference internal" href="#using-cobra-via-ament-cobra" id="id2">Using Cobra via ament_cobra</a></p></li>
<li><p><a class="reference internal" href="#using-cobra-via-colcon-test" id="id3">Using Cobra via colcon test</a></p></li>
</ul>
</div>
<div class="section" id="using-cobra-directly">
<h2><a class="toc-backref" href="#id1">Using Cobra directly</a><a class="headerlink" href="#using-cobra-directly" title="Permalink to this headline"></a></h2>
<p>Cobra is included in the Space ROS Docker image and can be invoked directly using the <code class="docutils literal notranslate"><span class="pre">cobra</span></code> command-line tool.
There are several additional resources listed on this site’s <a class="reference internal" href="../Related-Projects/Cobra.html"><span class="doc">Related Projects page for Cobra</span></a> that will help you to learn to use Cobra and its many command-line options.</p>
</div>
<div class="section" id="using-cobra-via-ament-cobra">
<h2><a class="toc-backref" href="#id2">Using Cobra via ament_cobra</a><a class="headerlink" href="#using-cobra-via-ament-cobra" title="Permalink to this headline"></a></h2>
<p>An easy way to use Cobra on your source files is via the <code class="docutils literal notranslate"><span class="pre">ament_cobra</span></code> command-line tool.
<code class="docutils literal notranslate"><span class="pre">ament_cobra</span></code> is a wrapper program for the Cobra tool that simplifies the interface to Cobra and helps to integrate the tool into the <a class="reference external" href="https://github.com/ament">ament</a>-based build system.
<code class="docutils literal notranslate"><span class="pre">ament_cobra</span></code> provides the following command-line interface:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">ament_cobra</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">include_dirs</span> <span class="p">[</span><span class="n">INCLUDE_DIRS</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">exclude</span> <span class="p">[</span><span class="n">EXCLUDE</span> <span class="o">...</span><span class="p">]]</span>
                <span class="p">[</span><span class="o">--</span><span class="n">ruleset</span> <span class="n">RULESET</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">compile_cmds</span> <span class="n">COMPILE_CMDS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">xunit</span><span class="o">-</span><span class="n">file</span> <span class="n">XUNIT_FILE</span><span class="p">]</span>
                <span class="p">[</span><span class="o">--</span><span class="n">sarif</span><span class="o">-</span><span class="n">file</span> <span class="n">SARIF_FILE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">cobra</span><span class="o">-</span><span class="n">version</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">verbose</span><span class="p">]</span>
                <span class="p">[</span><span class="n">paths</span> <span class="o">...</span><span class="p">]</span>

<span class="n">Analyze</span> <span class="n">source</span> <span class="n">code</span> <span class="n">using</span> <span class="n">the</span> <span class="n">cobra</span> <span class="n">static</span> <span class="n">analyzer</span><span class="o">.</span>

<span class="n">positional</span> <span class="n">arguments</span><span class="p">:</span>
<span class="n">paths</span>                 <span class="n">Files</span> <span class="ow">and</span><span class="o">/</span><span class="ow">or</span> <span class="n">directories</span> <span class="n">to</span> <span class="n">be</span> <span class="n">checked</span><span class="o">.</span> <span class="n">Directories</span> <span class="n">are</span> <span class="n">searched</span>
                        <span class="n">recursively</span> <span class="k">for</span> <span class="n">files</span> <span class="n">ending</span> <span class="ow">in</span> <span class="n">one</span> <span class="n">of</span> <span class="s1">&#39;.c&#39;</span><span class="p">,</span> <span class="s1">&#39;.cc&#39;</span><span class="p">,</span> <span class="s1">&#39;.cpp&#39;</span><span class="p">,</span> <span class="s1">&#39;.cxx&#39;</span><span class="o">.</span>
                        <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">])</span>

<span class="n">options</span><span class="p">:</span>
<span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>            <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
<span class="o">--</span><span class="n">include_dirs</span> <span class="p">[</span><span class="n">INCLUDE_DIRS</span> <span class="o">...</span><span class="p">]</span>
                        <span class="n">Include</span> <span class="n">directories</span> <span class="k">for</span> <span class="n">C</span><span class="o">/</span><span class="n">C</span><span class="o">++</span> <span class="n">files</span> <span class="n">being</span> <span class="n">checked</span><span class="o">.</span><span class="n">Each</span> <span class="n">directory</span> <span class="ow">is</span> <span class="n">passed</span>
                        <span class="n">to</span> <span class="n">cobra</span> <span class="k">as</span> <span class="s1">&#39;-I&lt;include_dir&gt;&#39;</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="kc">None</span><span class="p">)</span>
<span class="o">--</span><span class="n">exclude</span> <span class="p">[</span><span class="n">EXCLUDE</span> <span class="o">...</span><span class="p">]</span>
                        <span class="n">Exclude</span> <span class="n">C</span><span class="o">/</span><span class="n">C</span><span class="o">++</span> <span class="n">files</span> <span class="kn">from</span> <span class="nn">being</span> <span class="n">checked</span><span class="o">.</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="p">[])</span>
<span class="o">--</span><span class="n">ruleset</span> <span class="n">RULESET</span>     <span class="n">The</span> <span class="n">cobra</span> <span class="n">rule</span> <span class="nb">set</span> <span class="n">to</span> <span class="n">use</span> <span class="n">to</span> <span class="n">analyze</span> <span class="n">the</span> <span class="n">code</span><span class="p">:</span> <span class="n">basic</span><span class="p">,</span> <span class="n">cwe</span><span class="p">,</span> <span class="n">p10</span><span class="p">,</span> <span class="n">jpl</span><span class="p">,</span>
                        <span class="n">misra2012</span><span class="p">,</span> <span class="n">C</span><span class="o">++/</span><span class="n">autosar</span><span class="o">.</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="n">basic</span><span class="p">)</span>
<span class="o">--</span><span class="n">compile_cmds</span> <span class="n">COMPILE_CMDS</span>
                        <span class="n">The</span> <span class="n">compile_commands</span><span class="o">.</span><span class="n">json</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">which</span> <span class="n">to</span> <span class="n">gather</span> <span class="n">preprocessor</span>
                        <span class="n">directives</span><span class="o">.</span> <span class="n">This</span> <span class="n">option</span> <span class="n">will</span> <span class="n">take</span> <span class="n">precedence</span> <span class="n">over</span> <span class="n">the</span> <span class="o">--</span><span class="n">include_dirs</span>
                        <span class="n">options</span> <span class="ow">and</span> <span class="nb">any</span> <span class="n">directories</span> <span class="n">specified</span> <span class="n">using</span> <span class="o">--</span><span class="n">include_dirs</span> <span class="n">will</span> <span class="n">be</span> <span class="n">ignored</span><span class="o">.</span>
                        <span class="n">Instead</span><span class="p">,</span> <span class="n">ament_cobra</span> <span class="n">will</span> <span class="n">gather</span> <span class="nb">all</span> <span class="n">preprocessor</span> <span class="n">options</span> <span class="kn">from</span> <span class="nn">the</span>
                        <span class="n">compile_commands</span><span class="o">.</span><span class="n">json</span> <span class="n">file</span><span class="o">.</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="kc">None</span><span class="p">)</span>
<span class="o">--</span><span class="n">xunit</span><span class="o">-</span><span class="n">file</span> <span class="n">XUNIT_FILE</span>
                        <span class="n">Generate</span> <span class="n">a</span> <span class="n">xunit</span> <span class="n">compliant</span> <span class="n">XML</span> <span class="n">file</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="kc">None</span><span class="p">)</span>
<span class="o">--</span><span class="n">sarif</span><span class="o">-</span><span class="n">file</span> <span class="n">SARIF_FILE</span>
                        <span class="n">Generate</span> <span class="n">a</span> <span class="n">SARIF</span> <span class="n">file</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="kc">None</span><span class="p">)</span>
<span class="o">--</span><span class="n">cobra</span><span class="o">-</span><span class="n">version</span>       <span class="n">Get</span> <span class="n">the</span> <span class="n">cobra</span> <span class="n">version</span><span class="p">,</span> <span class="nb">print</span> <span class="n">it</span><span class="p">,</span> <span class="ow">and</span> <span class="n">then</span> <span class="n">exit</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
<span class="o">--</span><span class="n">verbose</span>             <span class="n">Display</span> <span class="n">verbose</span> <span class="n">output</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="basic-operation">
<h3>Basic operation<a class="headerlink" href="#basic-operation" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">ament_cobra</span></code> tool:</p>
<ul class="simple">
<li><p>Gathers a list of C/C++ filenames to be analyzed from from a list directories and/or files specified on the command line. Each directory is recursively scanned for target files. By default, if no filenames or directories are specified, <code class="docutils literal notranslate"><span class="pre">ament_cobra</span></code> scans for target files starting in the current working directory.</p></li>
<li><p>Analyzes the files using using one of a set of available rule sets (by default, <code class="docutils literal notranslate"><span class="pre">ament_cobra</span></code> uses Cobra’s <code class="docutils literal notranslate"><span class="pre">basic</span></code> rule set)</p></li>
<li><p>Saves detailed results to a file, the name of which is based on the ruleset used (<code class="docutils literal notranslate"><span class="pre">_Basic_.txt</span></code>, for example)</p></li>
<li><p>Writes a summary of the issues discovered to stdout</p></li>
</ul>
<p>For example, the following invocation of <code class="docutils literal notranslate"><span class="pre">ament_cobra</span></code>, without any command-line arguments,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>spaceros-user@c1b264aeb129:~/spaceros/src/rcutils/src$ ament_cobra
</pre></div>
</div>
<p>scans for all C and C++ files in the current working directory (<code class="docutils literal notranslate"><span class="pre">~/spaceros/src/rcutils/src</span></code>) and below, analyzes those files using Cobra’s Basic rule set, and produces the following output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="p">:</span> <span class="n">Shadow</span><span class="p">,</span> <span class="mi">9</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">Fct</span> <span class="n">names</span> <span class="n">also</span> <span class="n">used</span> <span class="k">as</span> <span class="n">variables</span>
<span class="mi">2</span><span class="p">:</span> <span class="n">Rval</span><span class="p">,</span> <span class="mi">1</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">Inconsistent</span> <span class="n">checking</span> <span class="k">return</span> <span class="n">value</span> <span class="n">of</span> <span class="n">function</span>
<span class="mi">3</span><span class="p">:</span> <span class="n">Ifelseif</span><span class="p">,</span> <span class="mi">9</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">Missing</span> <span class="k">else</span> <span class="n">at</span> <span class="n">end</span> <span class="n">of</span> <span class="k">if</span><span class="o">-</span><span class="k">else</span><span class="o">-</span><span class="k">if</span> <span class="n">chain</span>
<span class="mi">4</span><span class="p">:</span> <span class="n">SideEffect</span><span class="p">,</span> <span class="mi">3</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">More</span> <span class="n">than</span> <span class="n">one</span> <span class="n">side</span><span class="o">-</span><span class="n">effect</span> <span class="ow">in</span> <span class="n">expression</span>
<span class="mi">5</span><span class="p">:</span> <span class="n">Macros</span><span class="p">,</span> <span class="mi">46</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">Macro</span> <span class="n">argument</span> <span class="ow">not</span> <span class="n">enclosed</span> <span class="ow">in</span> <span class="n">parentheses</span>
<span class="n">detailed</span> <span class="n">results</span> <span class="n">are</span> <span class="ow">in</span> <span class="n">file</span> <span class="n">_Basic_</span><span class="o">.</span><span class="n">txt</span>

<span class="mi">68</span> <span class="n">errors</span>
</pre></div>
</div>
<p>The output includes a summary of the issues found and the number of occurances of each issue.
Cobra also saves a detailed summary of the analysis results in the file <code class="docutils literal notranslate"><span class="pre">_Basic_.txt</span></code>, which is a JSON-like file that contains an entry for each issue.
For example, the first couple of entries in <code class="docutils literal notranslate"><span class="pre">_Basic_.txt</span></code> for this run are as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
<span class="p">{</span> <span class="s2">&quot;type&quot;</span>      <span class="p">:</span>       <span class="s2">&quot;Fct names also used as variables&quot;</span><span class="p">,</span>
    <span class="s2">&quot;message&quot;</span>   <span class="p">:</span>       <span class="s2">&quot;lines 688..688&quot;</span><span class="p">,</span>
    <span class="s2">&quot;file&quot;</span>      <span class="p">:</span>       <span class="s2">&quot;/home/spaceros-user/spaceros/src/rcutils/src/logging.c&quot;</span><span class="p">,</span>
    <span class="s2">&quot;line&quot;</span>      <span class="p">:</span>       <span class="mi">688</span><span class="p">,</span>
    <span class="s2">&quot;cobra&quot;</span>     <span class="p">:</span>       <span class="s2">&quot;1 10 0&quot;</span>
<span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;type&quot;</span>      <span class="p">:</span>       <span class="s2">&quot;Fct names also used as variables&quot;</span><span class="p">,</span>
    <span class="s2">&quot;message&quot;</span>   <span class="p">:</span>       <span class="s2">&quot;lines 687..687&quot;</span><span class="p">,</span>
    <span class="s2">&quot;file&quot;</span>      <span class="p">:</span>       <span class="s2">&quot;/home/spaceros-user/spaceros/src/rcutils/src/logging.c&quot;</span><span class="p">,</span>
    <span class="s2">&quot;line&quot;</span>      <span class="p">:</span>       <span class="mi">687</span><span class="p">,</span>
    <span class="s2">&quot;cobra&quot;</span>     <span class="p">:</span>       <span class="s2">&quot;1 10 0&quot;</span>
<span class="p">}</span>
<span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="selecting-files-and-directories-to-analyze">
<h3>Selecting files and directories to analyze<a class="headerlink" href="#selecting-files-and-directories-to-analyze" title="Permalink to this headline"></a></h3>
<p>The positional (non-option) arguments passed to <code class="docutils literal notranslate"><span class="pre">ament_cobra</span></code> are expected to be files and/or directories to be analyzed.
Any directories specified are searched recursively for files ending in one of the following filename extensions: <code class="docutils literal notranslate"><span class="pre">.c</span></code>, <code class="docutils literal notranslate"><span class="pre">.cc</span></code>, <code class="docutils literal notranslate"><span class="pre">.cpp</span></code>, <code class="docutils literal notranslate"><span class="pre">.cxx</span></code>.
For example, to analyze a single file, one can specify the filename on the command line, as show below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>spaceros-user@c1b264aeb129:~/spaceros/src/rcutils/src$ ament_cobra string_array.c
1: Ifelseif, 2 patterns :: Missing else at end of if-else-if chain
detailed results are in file _Basic_.txt

2 errors
</pre></div>
</div>
</div>
<div class="section" id="selecting-the-ruleset-to-use">
<h3>Selecting the ruleset to use<a class="headerlink" href="#selecting-the-ruleset-to-use" title="Permalink to this headline"></a></h3>
<p>Cobra supports analyzing input source code according to multiple rule sets: Cobra’s Basic rule set (basic), <a class="reference external" href="https://cwe.mitre.org/">Common Weakness Enumeration</a> (cwe), the <a class="reference external" href="https://en.wikipedia.org/wiki/The_Power_of_10:_Rules_for_Developing_Safety-Critical_Code">Power of 10</a> (p10), the <a class="reference external" href="https://web.archive.org/web/20111015064908/http://lars-lab.jpl.nasa.gov/JPL_Coding_Standard_C.pdf">JPL Coding Standard</a> (jpl), <a class="reference external" href="https://en.wikipedia.org/wiki/MISRA_C#MISRA_C:2012">MISRA C 2012</a> (misra2012), and a subset of the <a class="reference external" href="https://www.autosar.org/fileadmin/user_upload/standards/adaptive/17-03/AUTOSAR_RS_CPP14Guidelines.pdf">AUTOSAR C++ 14</a>  rule set (C++/autosar).
You may specify one of these rulesets using the <code class="docutils literal notranslate"><span class="pre">--ruleset</span></code> command-line option.
If the <code class="docutils literal notranslate"><span class="pre">--ruleset</span></code> option is provided more than once on the command line, only the last one is respected.
The following example, run while in the <code class="docutils literal notranslate"><span class="pre">~/spaceros/src/rcutils/src</span></code> directory, shows how to process any C/C++ files in the current working directory and any subdirectories using the <code class="docutils literal notranslate"><span class="pre">p10</span></code> rule set:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>spaceros-user@c1b264aeb129:~/spaceros/src/rcutils/src$ ament_cobra --ruleset p10
</pre></div>
</div>
<p>Example output for the previous command is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Rule</span> <span class="mi">5</span><span class="p">:</span> <span class="n">counted</span> <span class="mi">9</span> <span class="n">assertions</span><span class="p">;</span> <span class="n">it</span> <span class="n">should</span> <span class="n">be</span> <span class="o">&gt;</span> <span class="mi">32</span>
<span class="mi">1</span><span class="p">:</span> <span class="n">P10_1a</span><span class="p">,</span> <span class="mi">1</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">use</span> <span class="n">of</span> <span class="n">recursion</span>
<span class="mi">2</span><span class="p">:</span> <span class="n">P10_1b</span><span class="p">,</span> <span class="mi">23</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">use</span> <span class="n">of</span> <span class="n">goto</span> <span class="n">setjmp</span> <span class="ow">or</span> <span class="n">longjmp</span>
<span class="mi">3</span><span class="p">:</span> <span class="n">P10_1</span><span class="p">,</span> <span class="mi">24</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">Rule</span> <span class="mi">1</span><span class="p">:</span> <span class="n">restrict</span> <span class="n">to</span> <span class="n">simple</span> <span class="n">control</span> <span class="n">flow</span> <span class="n">constructs</span>
<span class="mi">4</span><span class="p">:</span> <span class="n">P10_2a</span><span class="p">,</span> <span class="mi">1</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">loop</span> <span class="n">condition</span> <span class="n">must</span> <span class="n">contain</span> <span class="n">comparison</span>
<span class="mi">5</span><span class="p">:</span> <span class="n">P10_2</span><span class="p">,</span> <span class="mi">1</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">Rule</span> <span class="mi">2</span><span class="p">:</span> <span class="n">give</span> <span class="nb">all</span> <span class="n">loops</span> <span class="n">a</span> <span class="n">fixed</span> <span class="n">upper</span> <span class="n">bound</span>
<span class="mi">6</span><span class="p">:</span> <span class="n">P10_3</span><span class="p">,</span> <span class="mi">85</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">Rule</span> <span class="mi">3</span><span class="p">:</span> <span class="n">do</span> <span class="ow">not</span> <span class="n">use</span> <span class="n">dynamic</span> <span class="n">memory</span> <span class="n">allocation</span> <span class="n">after</span> <span class="n">initialization</span>
<span class="mi">7</span><span class="p">:</span> <span class="n">P10_4</span><span class="p">,</span> <span class="mi">6</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">Rule</span> <span class="mi">4</span><span class="p">:</span> <span class="n">limit</span> <span class="n">functions</span> <span class="n">to</span> <span class="n">no</span> <span class="n">more</span> <span class="n">than</span> <span class="mi">75</span> <span class="n">lines</span> <span class="n">of</span> <span class="n">text</span>
<span class="mi">8</span><span class="p">:</span> <span class="n">P10_5</span><span class="p">,</span> <span class="mi">174</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">Rule</span> <span class="mi">5</span><span class="p">:</span> <span class="n">use</span> <span class="n">minimally</span> <span class="n">two</span> <span class="n">assertions</span> <span class="n">per</span> <span class="n">function</span> <span class="n">on</span> <span class="n">average</span>
<span class="mi">9</span><span class="p">:</span> <span class="n">P10_pp</span><span class="p">,</span> <span class="mi">82</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">macro</span> <span class="n">definitions</span>
<span class="mi">10</span><span class="p">:</span> <span class="n">P10_6b</span><span class="p">,</span> <span class="mi">6</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">Limit</span> <span class="n">use</span> <span class="n">of</span> <span class="k">global</span> <span class="n">data</span>
<span class="mi">11</span><span class="p">:</span> <span class="n">P10_6</span><span class="p">,</span> <span class="mi">6</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">Limit</span> <span class="n">use</span> <span class="n">of</span> <span class="k">global</span> <span class="n">data</span>
<span class="mi">12</span><span class="p">:</span> <span class="n">P10_7b</span><span class="p">,</span> <span class="mi">93</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">failure</span> <span class="n">to</span> <span class="n">check</span> <span class="n">validity</span> <span class="n">ptr</span> <span class="n">param</span>
<span class="mi">13</span><span class="p">:</span> <span class="n">P10_7</span><span class="p">,</span> <span class="mi">93</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">failure</span> <span class="n">to</span> <span class="n">check</span> <span class="n">validity</span> <span class="n">ptr</span> <span class="n">param</span>
<span class="mi">14</span><span class="p">:</span> <span class="n">P10_8a</span><span class="p">,</span> <span class="mi">54</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">use</span> <span class="n">no</span> <span class="n">more</span> <span class="n">ifdefs</span> <span class="n">than</span> <span class="o">.</span><span class="n">h</span> <span class="n">files</span>
<span class="mi">15</span><span class="p">:</span> <span class="n">P10_8b</span><span class="p">,</span> <span class="mi">37</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">use</span> <span class="n">defines</span> <span class="n">only</span> <span class="ow">in</span> <span class="o">.</span><span class="n">h</span> <span class="n">files</span>
<span class="mi">16</span><span class="p">:</span> <span class="n">P10_8</span><span class="p">,</span> <span class="mi">91</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">Rule</span> <span class="mi">8</span><span class="p">:</span> <span class="n">limit</span> <span class="n">the</span> <span class="n">use</span> <span class="n">of</span> <span class="n">the</span> <span class="n">preprocessor</span> <span class="n">to</span> <span class="n">file</span> <span class="n">inclusion</span> <span class="ow">and</span> <span class="n">simple</span> <span class="n">macros</span>
<span class="mi">17</span><span class="p">:</span> <span class="n">P10_9a</span><span class="p">,</span> <span class="mi">7</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">typedef</span> <span class="n">hides</span> <span class="n">a</span> <span class="n">pointer</span> <span class="n">dereference</span>
<span class="mi">18</span><span class="p">:</span> <span class="n">P10_9d</span><span class="p">,</span> <span class="mi">3</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">use</span> <span class="n">no</span> <span class="n">more</span> <span class="n">than</span> <span class="mi">2</span> <span class="n">levels</span> <span class="n">of</span> <span class="n">dereferencing</span> <span class="p">(</span><span class="o">*</span> <span class="o">-&gt;</span> <span class="o">-&gt;</span><span class="p">)</span>
<span class="mi">19</span><span class="p">:</span> <span class="n">P10_9</span><span class="p">,</span> <span class="mi">10</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">Rule</span> <span class="mi">9</span><span class="p">:</span> <span class="n">limit</span> <span class="n">the</span> <span class="n">use</span> <span class="n">of</span> <span class="n">pointers</span><span class="p">,</span> <span class="n">use</span> <span class="n">no</span> <span class="n">more</span> <span class="n">than</span> <span class="mi">2</span> <span class="n">levels</span> <span class="n">of</span> <span class="n">dereferencing</span>
<span class="n">detailed</span> <span class="n">results</span> <span class="n">are</span> <span class="ow">in</span> <span class="n">file</span> <span class="n">_P10_</span><span class="o">.</span><span class="n">txt</span>

<span class="mi">797</span> <span class="n">errors</span>
</pre></div>
</div>
<p>In this case, because the <code class="docutils literal notranslate"><span class="pre">p10</span></code> ruleset was used, detailed output is stored in the file, <code class="docutils literal notranslate"><span class="pre">_P10_.txt</span></code>.</p>
</div>
<div class="section" id="generating-output-files">
<h3>Generating output files<a class="headerlink" href="#generating-output-files" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">ament_cobra</span></code> is able to parse the output file generated by <code class="docutils literal notranslate"><span class="pre">cobra</span></code> and generate JUnit XML and/or <a class="reference external" href="https://docs.oasis-open.org/sarif/sarif/v2.1.0/csprd01/sarif-v2.1.0-csprd01.html">SARIF</a> files.
JUnit XML files are typically used to interface to a CI system like Jenkins, while SARIF can be used by IDEs such as Visual Studio Code with a SARIF-enabled plugin to allow developers to interactively navigate the discovered issues.
The following command shows how one may process all C/C++ files in the current working directory or below using the <code class="docutils literal notranslate"><span class="pre">p10</span></code> rule set and generate both JUnit XML and SARIF output files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ament_cobra . --ruleset p10 --xunit-file p10.xml --sarif-file p10.sarif
</pre></div>
</div>
</div>
<div class="section" id="specifying-preprocessor-options">
<h3>Specifying preprocessor options<a class="headerlink" href="#specifying-preprocessor-options" title="Permalink to this headline"></a></h3>
<p>Cobra is able to invoke the C preprocessor before analyzing source code files.
<code class="docutils literal notranslate"><span class="pre">ament_cobra</span></code> provides an <code class="docutils literal notranslate"><span class="pre">--include-dirs</span></code> option which allows the user to specify a list of directories in which to look for #include files.
<code class="docutils literal notranslate"><span class="pre">ament_cobra</span></code> translates any directories specified with <code class="docutils literal notranslate"><span class="pre">include-dirs</span></code> to <code class="docutils literal notranslate"><span class="pre">-I</span></code> options when invoking the C preprocessor.</p>
<p><code class="docutils literal notranslate"><span class="pre">ament_cobra</span></code> also has a <code class="docutils literal notranslate"><span class="pre">--compile_cmds</span></code> command-line option.
The <code class="docutils literal notranslate"><span class="pre">--compile_cmds</span></code> option uses the <code class="docutils literal notranslate"><span class="pre">compile_commands.json</span></code> file output by the build system to incorporate any <code class="docutils literal notranslate"><span class="pre">-I</span></code>, <code class="docutils literal notranslate"><span class="pre">-D</span></code>, and <code class="docutils literal notranslate"><span class="pre">-U</span></code> options that were used for the original build.
The <code class="docutils literal notranslate"><span class="pre">--compile_cmds</span></code> option takes precedence over the <code class="docutils literal notranslate"><span class="pre">--include_dirs</span></code> options and any directories specified using <code class="docutils literal notranslate"><span class="pre">--include_dirs</span></code> will be ignored.
Instead, ament_cobra will gather all preprocessor options from the <code class="docutils literal notranslate"><span class="pre">compile_commands.json</span></code> file.
For example, if one first builds a particular package to produce the compile_commands.json output file, such as when using cmake’s <a class="reference external" href="https://cmake.org/cmake/help/latest/variable/CMAKE_EXPORT_COMPILE_COMMANDS.html">-DCMAKE_EXPORT_COMPILE_COMMANDS option</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>spaceros-user@c1b264aeb129:~/spaceros$ colcon build --packages-select rcutils --cmake-args -DCMAKE_EXPORT_COMPILE_COMMANDS=ON
</pre></div>
</div>
<p>One may then pass the compile_commands.json to <code class="docutils literal notranslate"><span class="pre">ament_cobra</span></code> using the <code class="docutils literal notranslate"><span class="pre">--compile_cmds</span></code> command-line option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>spaceros-user@c1b264aeb129:~/spaceros$ ament_cobra src/rcutils/src --compile_cmds ~/spaceros/build/rcutils/compile_commands.json
</pre></div>
</div>
</div>
<div class="section" id="displaying-verbose-output">
<h3>Displaying verbose output<a class="headerlink" href="#displaying-verbose-output" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">ament_cobra</span></code> has a <code class="docutils literal notranslate"><span class="pre">--verbose</span></code> command-line option that is handy when you want to see the exact command-line <code class="docutils literal notranslate"><span class="pre">ament_cobra</span></code> uses when invoking <code class="docutils literal notranslate"><span class="pre">cobra</span></code>.
For example, adding <code class="docutils literal notranslate"><span class="pre">--verbose</span></code> to the previous command line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>spaceros-user@c1b264aeb129:~/spaceros/src/rcutils/src$ ament_cobra --ruleset p10 --sarif-file 2.sarif --verbose
</pre></div>
</div>
<p>Shows the command-line used to invoke <code class="docutils literal notranslate"><span class="pre">cobra</span></code> in the first line of the output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">install</span><span class="o">/</span><span class="n">cobra_vendor</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">cobra</span> <span class="o">-</span><span class="n">C</span><span class="o">++</span> <span class="o">-</span><span class="n">comments</span> <span class="o">-</span><span class="n">json</span> <span class="o">-</span><span class="n">f</span> <span class="n">p10</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">allocator</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">array_list</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">char_array</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">cmdline_parser</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">env</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">error_handling</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">filesystem</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">find</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">format_string</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">hash_map</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">logging</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">process</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">qsort</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">repl_str</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">shared_library</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">snprintf</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">split</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">strcasecmp</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">strdup</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">strerror</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">string_array</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">string_map</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">time</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">time_unix</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">time_win32</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">uint8_array</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">spaceros</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">spaceros</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">rcutils</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">testing</span><span class="o">/</span><span class="n">fault_injection</span><span class="o">.</span><span class="n">c</span>
<span class="n">Rule</span> <span class="mi">5</span><span class="p">:</span> <span class="n">counted</span> <span class="mi">9</span> <span class="n">assertions</span><span class="p">;</span> <span class="n">it</span> <span class="n">should</span> <span class="n">be</span> <span class="o">&gt;</span> <span class="mi">32</span>
<span class="mi">1</span><span class="p">:</span> <span class="n">P10_1a</span><span class="p">,</span> <span class="mi">1</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">use</span> <span class="n">of</span> <span class="n">recursion</span>
<span class="mi">2</span><span class="p">:</span> <span class="n">P10_1b</span><span class="p">,</span> <span class="mi">23</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">use</span> <span class="n">of</span> <span class="n">goto</span> <span class="n">setjmp</span> <span class="ow">or</span> <span class="n">longjmp</span>
<span class="mi">3</span><span class="p">:</span> <span class="n">P10_1</span><span class="p">,</span> <span class="mi">24</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">Rule</span> <span class="mi">1</span><span class="p">:</span> <span class="n">restrict</span> <span class="n">to</span> <span class="n">simple</span> <span class="n">control</span> <span class="n">flow</span> <span class="n">constructs</span>
<span class="mi">4</span><span class="p">:</span> <span class="n">P10_2a</span><span class="p">,</span> <span class="mi">1</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">loop</span> <span class="n">condition</span> <span class="n">must</span> <span class="n">contain</span> <span class="n">comparison</span>
<span class="mi">5</span><span class="p">:</span> <span class="n">P10_2</span><span class="p">,</span> <span class="mi">1</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">Rule</span> <span class="mi">2</span><span class="p">:</span> <span class="n">give</span> <span class="nb">all</span> <span class="n">loops</span> <span class="n">a</span> <span class="n">fixed</span> <span class="n">upper</span> <span class="n">bound</span>
<span class="mi">6</span><span class="p">:</span> <span class="n">P10_3</span><span class="p">,</span> <span class="mi">85</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">Rule</span> <span class="mi">3</span><span class="p">:</span> <span class="n">do</span> <span class="ow">not</span> <span class="n">use</span> <span class="n">dynamic</span> <span class="n">memory</span> <span class="n">allocation</span> <span class="n">after</span> <span class="n">initialization</span>
<span class="mi">7</span><span class="p">:</span> <span class="n">P10_4</span><span class="p">,</span> <span class="mi">6</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">Rule</span> <span class="mi">4</span><span class="p">:</span> <span class="n">limit</span> <span class="n">functions</span> <span class="n">to</span> <span class="n">no</span> <span class="n">more</span> <span class="n">than</span> <span class="mi">75</span> <span class="n">lines</span> <span class="n">of</span> <span class="n">text</span>
<span class="mi">8</span><span class="p">:</span> <span class="n">P10_5</span><span class="p">,</span> <span class="mi">174</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">Rule</span> <span class="mi">5</span><span class="p">:</span> <span class="n">use</span> <span class="n">minimally</span> <span class="n">two</span> <span class="n">assertions</span> <span class="n">per</span> <span class="n">function</span> <span class="n">on</span> <span class="n">average</span>
<span class="mi">9</span><span class="p">:</span> <span class="n">P10_pp</span><span class="p">,</span> <span class="mi">82</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">macro</span> <span class="n">definitions</span>
<span class="mi">10</span><span class="p">:</span> <span class="n">P10_6b</span><span class="p">,</span> <span class="mi">6</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">Limit</span> <span class="n">use</span> <span class="n">of</span> <span class="k">global</span> <span class="n">data</span>
<span class="mi">11</span><span class="p">:</span> <span class="n">P10_6</span><span class="p">,</span> <span class="mi">6</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">Limit</span> <span class="n">use</span> <span class="n">of</span> <span class="k">global</span> <span class="n">data</span>
<span class="mi">12</span><span class="p">:</span> <span class="n">P10_7b</span><span class="p">,</span> <span class="mi">93</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">failure</span> <span class="n">to</span> <span class="n">check</span> <span class="n">validity</span> <span class="n">ptr</span> <span class="n">param</span>
<span class="mi">13</span><span class="p">:</span> <span class="n">P10_7</span><span class="p">,</span> <span class="mi">93</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">failure</span> <span class="n">to</span> <span class="n">check</span> <span class="n">validity</span> <span class="n">ptr</span> <span class="n">param</span>
<span class="mi">14</span><span class="p">:</span> <span class="n">P10_8a</span><span class="p">,</span> <span class="mi">54</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">use</span> <span class="n">no</span> <span class="n">more</span> <span class="n">ifdefs</span> <span class="n">than</span> <span class="o">.</span><span class="n">h</span> <span class="n">files</span>
<span class="mi">15</span><span class="p">:</span> <span class="n">P10_8b</span><span class="p">,</span> <span class="mi">37</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">use</span> <span class="n">defines</span> <span class="n">only</span> <span class="ow">in</span> <span class="o">.</span><span class="n">h</span> <span class="n">files</span>
<span class="mi">16</span><span class="p">:</span> <span class="n">P10_8</span><span class="p">,</span> <span class="mi">91</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">Rule</span> <span class="mi">8</span><span class="p">:</span> <span class="n">limit</span> <span class="n">the</span> <span class="n">use</span> <span class="n">of</span> <span class="n">the</span> <span class="n">preprocessor</span> <span class="n">to</span> <span class="n">file</span> <span class="n">inclusion</span> <span class="ow">and</span> <span class="n">simple</span> <span class="n">macros</span>
<span class="mi">17</span><span class="p">:</span> <span class="n">P10_9a</span><span class="p">,</span> <span class="mi">7</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">typedef</span> <span class="n">hides</span> <span class="n">a</span> <span class="n">pointer</span> <span class="n">dereference</span>
<span class="mi">18</span><span class="p">:</span> <span class="n">P10_9d</span><span class="p">,</span> <span class="mi">3</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">use</span> <span class="n">no</span> <span class="n">more</span> <span class="n">than</span> <span class="mi">2</span> <span class="n">levels</span> <span class="n">of</span> <span class="n">dereferencing</span> <span class="p">(</span><span class="o">*</span> <span class="o">-&gt;</span> <span class="o">-&gt;</span><span class="p">)</span>
<span class="mi">19</span><span class="p">:</span> <span class="n">P10_9</span><span class="p">,</span> <span class="mi">10</span> <span class="n">patterns</span> <span class="p">::</span> <span class="n">Rule</span> <span class="mi">9</span><span class="p">:</span> <span class="n">limit</span> <span class="n">the</span> <span class="n">use</span> <span class="n">of</span> <span class="n">pointers</span><span class="p">,</span> <span class="n">use</span> <span class="n">no</span> <span class="n">more</span> <span class="n">than</span> <span class="mi">2</span> <span class="n">levels</span> <span class="n">of</span> <span class="n">dereferencing</span>
<span class="n">detailed</span> <span class="n">results</span> <span class="n">are</span> <span class="ow">in</span> <span class="n">file</span> <span class="n">_P10_</span><span class="o">.</span><span class="n">txt</span>

<span class="mi">797</span> <span class="n">errors</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="using-cobra-via-colcon-test">
<h2><a class="toc-backref" href="#id3">Using Cobra via colcon test</a><a class="headerlink" href="#using-cobra-via-colcon-test" title="Permalink to this headline"></a></h2>
<p><a class="reference external" href="https://colcon.readthedocs.io/en/released/">colcon</a> is a command-line tool used to build and test packages in a workspace.
<code class="docutils literal notranslate"><span class="pre">colcon</span></code> operates by traversing the directory hierarchy in a workspace, generating a graph of package dependencies, and performing an operation (such as <code class="docutils literal notranslate"><span class="pre">build</span></code> or <code class="docutils literal notranslate"><span class="pre">test</span></code>) on one or more packages.</p>
<p>To use Cobra via colcon test on the Space ROS source code, first launch the Space ROS Docker image from your host system:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ docker run -it --rm osrf/space-ros
</pre></div>
</div>
<p>The container starts with the user in the <code class="docutils literal notranslate"><span class="pre">spaceros</span></code> directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>spaceros-user@5218e73f96c6:~/spaceros$
</pre></div>
</div>
<p>Here, you’ll see the file, <code class="docutils literal notranslate"><span class="pre">exact.repos</span></code>, which contains the exact versions of each package used when building the Space ROS image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>spaceros-user@5218e73f96c6:~/spaceros$ ll
total 32
drwxr-xr-x   1 spaceros-user spaceros-user  4096 Dec  9 16:39 ./
drwxr-x---   1 spaceros-user spaceros-user  4096 Dec  9 16:24 ../
-rw-r--r--   1 spaceros-user spaceros-user  8485 Apr 16  2020 exact.repos
drwxr-xr-x 213 spaceros-user spaceros-user 12288 Dec  9 16:39 install/
</pre></div>
</div>
<p>In order to minimize the size of the Docker image, the Space ROS image doesn’t include the source code.
However, you can pull the source code into a <code class="docutils literal notranslate"><span class="pre">src</span></code> directory using the following commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>spaceros-user@5218e73f96c6:~/spaceros$ mkdir src
spaceros-user@5218e73f96c6:~/spaceros$ vcs import src &lt; exact.repos
</pre></div>
</div>
<p>Now we’re ready to build and execute tests for Space ROS.</p>
<div class="section" id="running-all-tests">
<h3>Running all tests<a class="headerlink" href="#running-all-tests" title="Permalink to this headline"></a></h3>
<p>To run all of the Space ROS tests, first perform a full build of the Space ROS source code.
For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>spaceros-user@c1b264aeb129:~/spaceros$ colcon build --cmake-args -DCMAKE_BUILD_TYPE=Release -DCMAKE_EXPORT_COMPILE_COMMANDS=ON
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using Cobra via <code class="docutils literal notranslate"><span class="pre">colcon</span> <span class="pre">test</span></code>, make sure to pass the CMAKE_EXPORT_COMPILE_COMMANDS=ON option to <code class="docutils literal notranslate"><span class="pre">cmake</span></code> when building the source, as shown in the above example.
<code class="docutils literal notranslate"><span class="pre">ament_cobra</span></code> will use the resulting <code class="docutils literal notranslate"><span class="pre">compile_commands.json</span></code> file to gather the proper preprocessor options when analyzing each source file.</p>
</div>
<p>Then, to run all of the tests, which includes which includes executing the unit tests and running the static analyzers, run the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>spaceros-user@c1b264aeb129:~/spaceros$ colcon test
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Both <code class="docutils literal notranslate"><span class="pre">colcon</span> <span class="pre">build</span></code> and <code class="docutils literal notranslate"><span class="pre">colcon</span> <span class="pre">test</span></code> will take a while complete in this case as they are operating on the entire code base for Space ROS.</p>
</div>
</div>
<div class="section" id="running-tests-for-an-individual-package">
<h3>Running tests for an individual package<a class="headerlink" href="#running-tests-for-an-individual-package" title="Permalink to this headline"></a></h3>
<p>It is also possible to target just a single package with <code class="docutils literal notranslate"><span class="pre">colcon</span></code>.
For example, one may build just the <code class="docutils literal notranslate"><span class="pre">rcutils</span></code> package using the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>spaceros-user@c1b264aeb129:~/spaceros$ colcon build --packages-select rcutils --allow-overriding rcutils --cmake-args -DCMAKE_BUILD_TYPE=Release -DCMAKE_EXPORT_COMPILE_COMMANDS=ON
</pre></div>
</div>
<p>Tests for <code class="docutils literal notranslate"><span class="pre">rcutils</span></code> can then be run using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>spaceros-user@c1b264aeb129:~/spaceros$ colcon test --packages-select rcutils
</pre></div>
</div>
</div>
<div class="section" id="running-an-individual-test">
<h3>Running an individual test<a class="headerlink" href="#running-an-individual-test" title="Permalink to this headline"></a></h3>
<p>It is also possible using <code class="docutils literal notranslate"><span class="pre">colcon</span></code> to target individual tests, such as running only the Cobra static analyzer.
This is accomplished using <code class="docutils literal notranslate"><span class="pre">colcon</span></code>’s <code class="docutils literal notranslate"><span class="pre">ctest-args</span></code> option and specifying which test to run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>spaceros-user@c1b264aeb129:~/spaceros$ colcon test --packages-select rcutils --ctest-args -L cobra
</pre></div>
</div>
</div>
<div class="section" id="viewing-test-output">
<h3>Viewing test output<a class="headerlink" href="#viewing-test-output" title="Permalink to this headline"></a></h3>
<p>In all cases, test output is in the directory associated with each package.
For example, for <code class="docutils literal notranslate"><span class="pre">rcutils</span></code> the output is in <code class="docutils literal notranslate"><span class="pre">build/rcutils/test_results/rcutils</span></code>.
The output includes the SAIRF and JUnit XML files associated with each test.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>spaceros-user@5218e73f96c6:~/spaceros/build/rcutils/test_results/rcutils$ ls -l *.sarif
-rw-r--r-- 1 spaceros-user spaceros-user  57622 Dec 16 19:41 clang_tidy.sarif
-rw-r--r-- 1 spaceros-user spaceros-user   3062 Dec 16 19:43 cobra-autosar.sarif
-rw-r--r-- 1 spaceros-user spaceros-user  20158 Dec 16 19:43 copyright.sarif
-rw-r--r-- 1 spaceros-user spaceros-user    835 Dec 16 19:41 cppcheck_logging_macros.sarif
-rw-r--r-- 1 spaceros-user spaceros-user 999106 Dec 16 19:46 cppcheck.sarif
-rw-r--r-- 1 spaceros-user spaceros-user    706 Dec 16 19:41 cpplint_logging_macros.sarif
-rw-r--r-- 1 spaceros-user spaceros-user  15950 Dec 16 19:46 cpplint.sarif
-rw-r--r-- 1 spaceros-user spaceros-user   1060 Dec 16 19:41 uncrustify_logging_macros.sarif
-rw-r--r-- 1 spaceros-user spaceros-user  19203 Dec 16 19:46 uncrustify.sarif
</pre></div>
</div>
<p>You can inspect these files manually or open them using the <a class="reference internal" href="Use-The-Dashboard.html"><span class="doc">Space ROS Dashboard</span></a>.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Reproducing-CI-Results.html" class="btn btn-neutral float-left" title="Reproducing CI Results Locally" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="MC-DC-Testing-Tool.html" class="btn btn-neutral float-right" title="Using the MC/DC Testing Tool" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Open Robotics.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>